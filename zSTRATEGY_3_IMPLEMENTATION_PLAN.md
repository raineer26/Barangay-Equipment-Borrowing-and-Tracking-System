# ğŸ“‹ Strategy 3: Notification Tab Implementation Plan

## ğŸ¯ Overview

**Strategy 3** transforms the User Profile page into a **tabbed interface** with a dedicated Notifications section. This is the most comprehensive notification system that includes:

- âœ… **Complete notification history** (not just current alerts)
- âœ… **Read/unread tracking** (persistent across sessions)
- âœ… **Multiple notification types** (booking reminders, status changes, admin messages)
- âœ… **Scalable architecture** (easy to add new notification types)
- âœ… **Professional UI** (familiar tab pattern)

---

## ğŸ”„ What Changes from Current Implementation

### Current State (Strategy 1 + 2)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [User Name]    ğŸ””(3)         [Logout]          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš ï¸ Banner: Booking tomorrow...                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Personal Info  â”‚  Request Status                â”‚
â”‚                â”‚  [Filter: All]                 â”‚
â”‚                â”‚  Request cards...              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### New State (Strategy 3)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [User Name]                      [Logout]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Personal Info] [Requests] [Notifications (3)] â”‚ â† NEW TAB BAR
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Content area (changes based on active tab)      â”‚
â”‚                                                 â”‚
â”‚ IF NOTIFICATIONS TAB:                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ ğŸ”” Booking Reminder               [âœ“]   â”‚    â”‚
â”‚ â”‚ Your booking is tomorrow                â”‚    â”‚
â”‚ â”‚ Tents & Chairs â€¢ 2 hours ago            â”‚    â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚ â”‚ âœ… Status Update                  [âœ“]   â”‚    â”‚
â”‚ â”‚ Your request was approved               â”‚    â”‚
â”‚ â”‚ Conference Room â€¢ 1 day ago             â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Architecture Changes

### 1. **Firestore Database Schema** (NEW)

Create a new collection to store persistent notifications:

```javascript
// Collection: notifications
// Document ID: Auto-generated by Firestore

{
  userId: "string",              // User who receives this notification
  type: "string",                // "booking_reminder" | "status_change" | "admin_message"
  requestId: "string",           // Related booking ID (if applicable)
  requestType: "string",         // "tents-chairs" | "conference-room"
  title: "string",               // "Booking Reminder", "Status Update", etc.
  message: "string",             // Full notification text
  read: boolean,                 // false = unread, true = read
  createdAt: Timestamp,          // When notification was created
  actionUrl: "string",           // Optional: URL to navigate to
  metadata: {                    // Optional: Additional data
    eventDate: "string",
    status: "string",
    etc...
  }
}
```

**Example Documents**:

```javascript
// Booking Reminder Notification
{
  userId: "abc123",
  type: "booking_reminder",
  requestId: "booking456",
  requestType: "tents-chairs",
  title: "Booking Reminder",
  message: "Your tents & chairs booking is tomorrow (November 8, 2025). Please prepare for delivery.",
  read: false,
  createdAt: Timestamp(2025-11-07 14:30:00),
  actionUrl: null,
  metadata: {
    eventDate: "2025-11-08",
    deliveryMode: "Delivery"
  }
}

// Status Change Notification
{
  userId: "abc123",
  type: "status_change",
  requestId: "booking789",
  requestType: "conference-room",
  title: "Request Approved",
  message: "Your conference room booking request has been approved by the admin.",
  read: true,
  createdAt: Timestamp(2025-11-05 09:15:00),
  actionUrl: null,
  metadata: {
    oldStatus: "pending",
    newStatus: "approved",
    eventDate: "2025-11-20"
  }
}

// Admin Message Notification
{
  userId: "abc123",
  type: "admin_message",
  requestId: null,
  requestType: null,
  title: "Important Announcement",
  message: "The barangay office will be closed on November 15 for the holiday.",
  read: false,
  createdAt: Timestamp(2025-11-06 10:00:00),
  actionUrl: null,
  metadata: {}
}
```

---

### 2. **HTML Structure Changes**

#### A. Remove Bell Icon & Banners (Already Implemented)

**REMOVE** these sections from `UserProfile.html`:

```html
<!-- REMOVE THIS (lines 53-59) -->
<div class="notification-bell">
  <button class="bell-btn" id="bellButton" aria-label="Notifications" title="View notifications">
    <span class="bell-icon">ğŸ””</span>
    <span class="notification-badge" id="notificationBadge">0</span>
  </button>
</div>

<!-- REMOVE THIS (line 64) -->
<div id="notificationBanners" class="notification-banners"></div>
```

#### B. Add Tab Navigation Bar

**ADD** after `.user-profile-header` closing `</div>` (before `.user-profile-content`):

```html
<!-- Tab Navigation Bar -->
<div class="profile-tabs">
  <button class="profile-tab active" data-tab="info" aria-selected="true">
    Personal Info
  </button>
  <button class="profile-tab" data-tab="requests" aria-selected="false">
    Requests
  </button>
  <button class="profile-tab" data-tab="notifications" aria-selected="false">
    Notifications 
    <span class="tab-badge" id="notifTabBadge">0</span>
  </button>
</div>
```

#### C. Wrap Existing Content in Tab Panes

**REPLACE** `.user-profile-content` structure:

**OLD**:
```html
<div class="user-profile-content">
  <div class="user-info-card">
    <!-- Personal info fields -->
  </div>
  <div class="user-request-status">
    <!-- Request cards -->
  </div>
</div>
```

**NEW**:
```html
<div class="user-profile-content">
  <!-- Tab 1: Personal Info -->
  <div class="tab-pane active" id="infoTab">
    <div class="user-info-card">
      <!-- Keep all existing personal info HTML -->
      <h2>Personal Information</h2>
      <div class="info-item"><span class="info-label">First Name</span><span id="infoFirstName"></span></div>
      <div class="info-item"><span class="info-label">Last Name</span><span id="infoLastName"></span></div>
      <div class="info-item"><span class="info-label">Contact Number</span><span id="infoContactNumber"></span></div>
      <div class="info-item"><span class="info-label">Email Address</span><span id="infoEmail"></span></div>
      <div class="info-item"><span class="info-label">Address</span><span id="infoAddress"></span></div>
      <div class="user-profile-actions">
        <button class="edit-profile-btn"><span>ğŸ–‰</span> Edit Profile</button>
        <button class="change-password-btn"><span>ğŸ”‘</span> Change Password</button>
      </div>
    </div>
  </div>

  <!-- Tab 2: Requests -->
  <div class="tab-pane" id="requestsTab">
    <div class="user-request-status">
      <!-- Keep all existing request status HTML -->
      <div class="request-status-header">
        <h2>Request Status</h2>
        <div class="request-filters-inline">
          <label for="statusFilter">Filter:</label>
          <select id="statusFilter" class="filter-select">
            <option value="all">All Requests</option>
            <option value="pending">Pending</option>
            <option value="approved">Approved</option>
            <option value="in-progress">In Progress</option>
            <option value="completed">Completed</option>
            <option value="rejected">Rejected</option>
            <option value="cancelled">Cancelled</option>
          </select>
        </div>
      </div>
      <div class="request-cards">
        <!-- Request cards dynamically loaded -->
      </div>
      <div class="dropdown custom-dropdown">
        <button class="make-request-btn" aria-haspopup="true" aria-expanded="false">
          <span>Make New Request</span>
          <svg class="dropdown-caret" width="14" height="9" viewBox="0 0 14 9" aria-hidden="true" focusable="false">
            <path d="M1 1l6 6 6-6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" fill="none"></path>
          </svg>
        </button>
        <ul class="dropdown-menu show-on-parent-hover">
          <li><a href="tents-calendar.html">Tents and Chairs</a></li>
          <li><a href="conference-room.html">Conference Room</a></li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Tab 3: Notifications (NEW) -->
  <div class="tab-pane" id="notificationsTab">
    <div class="notifications-panel">
      <div class="notifications-header">
        <h2>Notifications</h2>
        <button class="mark-all-read-btn" id="markAllReadBtn">
          Mark All as Read
        </button>
      </div>
      
      <div class="notifications-filter">
        <button class="notif-filter-btn active" data-filter="all">
          All <span class="filter-count" id="countAll">0</span>
        </button>
        <button class="notif-filter-btn" data-filter="unread">
          Unread <span class="filter-count" id="countUnread">0</span>
        </button>
        <button class="notif-filter-btn" data-filter="read">
          Read <span class="filter-count" id="countRead">0</span>
        </button>
      </div>

      <div class="notifications-list" id="notificationsList">
        <!-- Notifications will be dynamically loaded here -->
      </div>
    </div>
  </div>
</div>
```

#### D. Keep All Modals (No Changes)

Modals remain unchanged:
- âœ… Edit Profile Modal
- âœ… Change Password Modal  
- âœ… Forgot Password Modal

---

### 3. **CSS Changes**

#### A. Remove Current Notification Styles (Optional)

If you want to completely remove Strategy 1+2 styles, **DELETE** from `style.css`:
- Lines ~1099-1340 (notification bell and banner styles)

#### B. Add Tab Navigation Styles

**ADD** to `style.css` (after `.user-profile-header` styles, around line 1098):

```css
/* ========================================
   PROFILE TABS NAVIGATION
   ======================================== */

.profile-tabs {
  display: flex;
  gap: 8px;
  max-width: 900px;
  margin: 0 auto 24px auto;
  background: white;
  border-radius: 10px;
  padding: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

.profile-tab {
  flex: 1;
  padding: 14px 20px;
  background: transparent;
  border: none;
  border-radius: 6px;
  font-family: 'Poppins', sans-serif;
  font-size: 0.95rem;
  font-weight: 500;
  color: #666;
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.profile-tab:hover {
  background: #f5f5f5;
  color: #281abc;
}

.profile-tab.active {
  background: linear-gradient(135deg, #281abc 0%, #1a0e7a 100%);
  color: white;
  box-shadow: 0 4px 12px rgba(40, 26, 188, 0.25);
}

.tab-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 22px;
  height: 22px;
  padding: 0 6px;
  background: #d32f2f;
  color: white;
  border-radius: 11px;
  font-size: 0.75rem;
  font-weight: 600;
  line-height: 1;
}

.profile-tab.active .tab-badge {
  background: white;
  color: #281abc;
}

.tab-badge:empty,
.tab-badge[data-count="0"] {
  display: none;
}

/* ========================================
   TAB CONTENT PANES
   ======================================== */

.tab-pane {
  display: none;
  animation: fadeIn 0.3s ease-in;
}

.tab-pane.active {
  display: block;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Adjust existing .user-profile-content to accommodate tabs */
.user-profile-content {
  /* Remove grid layout when using tabs */
  display: block;
  max-width: 900px;
  margin: 0 auto;
}

/* Tab 1 (Personal Info) - Keep centered card */
#infoTab .user-info-card {
  max-width: 600px;
  margin: 0 auto;
}

/* Tab 2 (Requests) - Full width */
#requestsTab .user-request-status {
  width: 100%;
}

/* ========================================
   NOTIFICATIONS PANEL (TAB 3)
   ======================================== */

.notifications-panel {
  background: white;
  border: 1px solid #d9d9d9;
  border-radius: 12px;
  padding: 24px;
  min-height: 500px;
}

.notifications-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 16px;
  border-bottom: 2px solid #f0f0f0;
}

.notifications-header h2 {
  font-family: 'League Spartan', sans-serif;
  font-size: 1.5rem;
  color: #281abc;
  margin: 0;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.mark-all-read-btn {
  padding: 8px 16px;
  background: transparent;
  border: 1.5px solid #281abc;
  border-radius: 6px;
  color: #281abc;
  font-family: 'Poppins', sans-serif;
  font-size: 0.85rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.mark-all-read-btn:hover {
  background: #281abc;
  color: white;
}

.mark-all-read-btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
  border-color: #ccc;
  color: #ccc;
}

/* ========================================
   NOTIFICATION FILTERS
   ======================================== */

.notifications-filter {
  display: flex;
  gap: 12px;
  margin-bottom: 24px;
}

.notif-filter-btn {
  padding: 10px 18px;
  background: white;
  border: 1.5px solid #ddd;
  border-radius: 8px;
  color: #666;
  font-family: 'Poppins', sans-serif;
  font-size: 0.9rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  gap: 8px;
}

.notif-filter-btn:hover {
  border-color: #281abc;
  color: #281abc;
}

.notif-filter-btn.active {
  background: #281abc;
  border-color: #281abc;
  color: white;
}

.filter-count {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 24px;
  height: 24px;
  padding: 0 6px;
  background: #f0f0f0;
  color: #666;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 600;
}

.notif-filter-btn.active .filter-count {
  background: rgba(255, 255, 255, 0.2);
  color: white;
}

/* ========================================
   NOTIFICATIONS LIST
   ======================================== */

.notifications-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.notifications-list:empty::after {
  content: 'No notifications yet';
  display: block;
  text-align: center;
  padding: 60px 20px;
  color: #999;
  font-family: 'Poppins', sans-serif;
  font-size: 1rem;
}

/* Individual Notification Item */
.notification-item {
  display: flex;
  gap: 16px;
  padding: 16px;
  background: white;
  border: 1px solid #e0e0e0;
  border-radius: 10px;
  transition: all 0.2s ease;
  cursor: pointer;
  position: relative;
}

.notification-item:hover {
  border-color: #281abc;
  box-shadow: 0 4px 12px rgba(40, 26, 188, 0.1);
  transform: translateX(4px);
}

.notification-item.unread {
  background: linear-gradient(135deg, #f0f4ff 0%, #e8f0ff 100%);
  border-left: 4px solid #281abc;
}

.notification-item.unread::before {
  content: '';
  position: absolute;
  top: 20px;
  right: 16px;
  width: 10px;
  height: 10px;
  background: #d32f2f;
  border-radius: 50%;
  box-shadow: 0 0 0 3px rgba(211, 47, 47, 0.2);
}

/* Notification Icon */
.notification-icon {
  flex-shrink: 0;
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  font-size: 1.5rem;
  background: #f5f5f5;
}

.notification-item.unread .notification-icon {
  background: linear-gradient(135deg, #281abc 0%, #1a0e7a 100%);
}

.notification-icon.type-reminder {
  background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
}

.notification-icon.type-status {
  background: linear-gradient(135deg, #d4f4dd 0%, #b8e6c3 100%);
}

.notification-icon.type-message {
  background: linear-gradient(135deg, #d1ecf1 0%, #b8dfe5 100%);
}

/* Notification Content */
.notification-content {
  flex: 1;
  min-width: 0; /* Allows text truncation */
}

.notification-title {
  font-family: 'Poppins', sans-serif;
  font-size: 0.95rem;
  font-weight: 600;
  color: #333;
  margin: 0 0 6px 0;
}

.notification-item.unread .notification-title {
  color: #281abc;
}

.notification-message {
  font-family: 'Poppins', sans-serif;
  font-size: 0.9rem;
  color: #666;
  line-height: 1.5;
  margin: 0 0 8px 0;
}

.notification-meta {
  display: flex;
  align-items: center;
  gap: 12px;
  font-family: 'Poppins', sans-serif;
  font-size: 0.75rem;
  color: #999;
}

.notification-type-badge {
  display: inline-block;
  padding: 3px 10px;
  background: #f0f0f0;
  border-radius: 4px;
  font-weight: 500;
  color: #666;
}

.notification-time {
  display: flex;
  align-items: center;
  gap: 4px;
}

/* Notification Actions */
.notification-actions {
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding-left: 12px;
  border-left: 1px solid #e0e0e0;
}

.notification-action-btn {
  padding: 6px 14px;
  background: transparent;
  border: 1px solid #ddd;
  border-radius: 6px;
  color: #666;
  font-family: 'Poppins', sans-serif;
  font-size: 0.8rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  white-space: nowrap;
}

.notification-action-btn:hover {
  background: #f5f5f5;
  border-color: #281abc;
  color: #281abc;
}

.notification-action-btn.mark-read {
  color: #1e7e34;
  border-color: #1e7e34;
}

.notification-action-btn.mark-read:hover {
  background: #d4f4dd;
}

.notification-action-btn.delete {
  color: #d32f2f;
  border-color: #d32f2f;
}

.notification-action-btn.delete:hover {
  background: #fee;
}

/* ========================================
   RESPONSIVE DESIGN
   ======================================== */

@media (max-width: 768px) {
  .profile-tabs {
    flex-direction: column;
    gap: 6px;
  }
  
  .profile-tab {
    width: 100%;
  }
  
  .notifications-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
  }
  
  .notifications-filter {
    flex-wrap: wrap;
  }
  
  .notification-item {
    flex-direction: column;
  }
  
  .notification-actions {
    flex-direction: row;
    border-left: none;
    border-top: 1px solid #e0e0e0;
    padding-left: 0;
    padding-top: 12px;
  }
}
```

---

### 4. **JavaScript Changes**

#### A. Remove Current Notification Functions (Optional)

If removing Strategy 1+2, **DELETE** from `script.js`:
- `loadNotificationBanners()` (~line 1870-2070)
- `createNotificationBanner()` (~line 2070-2220)
- `updateNotificationCount()` (~line 2220-2310)
- `startNotificationCountRefresh()` (~line 2310-2370)

#### B. Add Tab Switching Logic

**ADD** to `script.js` in the UserProfile section (~line 1145):

```javascript
// ========================================
// TAB SWITCHING FUNCTIONALITY
// ========================================

if (window.location.pathname.endsWith('UserProfile.html')) {
  console.log('[UserProfile] â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
  console.log('[UserProfile] Initializing tab navigation...');
  
  // Initialize tab switching
  initializeProfileTabs();
  
  // Rest of existing initialization...
  onAuthStateChanged(auth, async (user) => {
    if (user) {
      console.log('[UserProfile] User authenticated:', user.uid);
      await loadUserData();
      await loadUserRequests();
      
      // Load notifications when user is authenticated
      await loadNotifications();
      
      // Start auto-refresh for notification count
      startNotificationRefresh();
    } else {
      window.location.href = "index.html";
    }
  });
}

/**
 * Initialize profile tab navigation
 */
function initializeProfileTabs() {
  console.log('[Tabs] Initializing tab navigation system');
  
  const tabs = document.querySelectorAll('.profile-tab');
  const panes = document.querySelectorAll('.tab-pane');
  
  if (!tabs.length || !panes.length) {
    console.warn('[Tabs] âš ï¸ Tab elements not found');
    return;
  }
  
  console.log(`[Tabs] Found ${tabs.length} tabs and ${panes.length} panes`);
  
  tabs.forEach(tab => {
    tab.addEventListener('click', function() {
      const targetTab = this.dataset.tab;
      console.log(`[Tabs] ğŸ–±ï¸ Tab clicked: ${targetTab}`);
      
      // Remove active class from all tabs
      tabs.forEach(t => {
        t.classList.remove('active');
        t.setAttribute('aria-selected', 'false');
      });
      
      // Remove active class from all panes
      panes.forEach(p => p.classList.remove('active'));
      
      // Add active class to clicked tab
      this.classList.add('active');
      this.setAttribute('aria-selected', 'true');
      
      // Show corresponding pane
      const targetPane = document.getElementById(`${targetTab}Tab`);
      if (targetPane) {
        targetPane.classList.add('active');
        console.log(`[Tabs] âœ“ Switched to ${targetTab} tab`);
        
        // If notifications tab, refresh the list
        if (targetTab === 'notifications') {
          console.log('[Tabs] ğŸ”” Notifications tab activated, refreshing list...');
          loadNotifications();
        }
      } else {
        console.error(`[Tabs] âŒ Pane not found: ${targetTab}Tab`);
      }
    });
  });
  
  console.log('[Tabs] âœ“ Tab navigation initialized');
}
```

#### C. Add Notification CRUD Functions

**ADD** to `script.js` (after tab initialization):

```javascript
// ========================================
// NOTIFICATIONS MANAGEMENT
// ========================================

let currentNotificationFilter = 'all'; // 'all', 'unread', 'read'
let allNotifications = []; // Cache of all notifications

/**
 * Load notifications from Firestore
 */
async function loadNotifications() {
  console.log('[Notifications] â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
  console.log('[Notifications] Loading notifications from Firestore...');
  
  const user = auth.currentUser;
  if (!user) {
    console.warn('[Notifications] âš ï¸ No authenticated user');
    return;
  }
  
  const notificationsList = document.getElementById('notificationsList');
  if (!notificationsList) {
    console.warn('[Notifications] âš ï¸ Notifications list element not found');
    return;
  }
  
  try {
    // Query notifications for current user
    const q = query(
      collection(db, "notifications"),
      where("userId", "==", user.uid),
      orderBy("createdAt", "desc"),
      limit(100) // Limit to last 100 notifications
    );
    
    console.log('[Notifications] ğŸ” Querying Firestore for user:', user.uid);
    const querySnapshot = await getDocs(q);
    console.log(`[Notifications] ğŸ“Š Found ${querySnapshot.size} notifications`);
    
    // Store all notifications
    allNotifications = [];
    querySnapshot.forEach(doc => {
      allNotifications.push({
        id: doc.id,
        ...doc.data()
      });
    });
    
    // Update filter counts
    updateNotificationCounts();
    
    // Render filtered notifications
    renderNotifications();
    
    console.log('[Notifications] âœ“ Notifications loaded successfully');
    
  } catch (error) {
    console.error('[Notifications] âŒ Error loading notifications:', error);
    notificationsList.innerHTML = `
      <div style="text-align: center; padding: 40px; color: #d32f2f;">
        <p>âš ï¸ Error loading notifications</p>
        <p style="font-size: 0.85rem; color: #999;">${error.message}</p>
      </div>
    `;
  }
}

/**
 * Update notification counts for filters
 */
function updateNotificationCounts() {
  console.log('[Notifications] ğŸ“Š Updating filter counts...');
  
  const unreadCount = allNotifications.filter(n => !n.read).length;
  const readCount = allNotifications.filter(n => n.read).length;
  const totalCount = allNotifications.length;
  
  // Update filter count badges
  const countAll = document.getElementById('countAll');
  const countUnread = document.getElementById('countUnread');
  const countRead = document.getElementById('countRead');
  
  if (countAll) countAll.textContent = totalCount;
  if (countUnread) countUnread.textContent = unreadCount;
  if (countRead) countRead.textContent = readCount;
  
  // Update tab badge
  const tabBadge = document.getElementById('notifTabBadge');
  if (tabBadge) {
    tabBadge.textContent = unreadCount;
    tabBadge.setAttribute('data-count', unreadCount);
  }
  
  // Enable/disable "Mark All as Read" button
  const markAllBtn = document.getElementById('markAllReadBtn');
  if (markAllBtn) {
    markAllBtn.disabled = unreadCount === 0;
  }
  
  console.log(`[Notifications] Counts - Total: ${totalCount}, Unread: ${unreadCount}, Read: ${readCount}`);
}

/**
 * Render notifications based on current filter
 */
function renderNotifications() {
  console.log(`[Notifications] ğŸ¨ Rendering notifications (filter: ${currentNotificationFilter})`);
  
  const notificationsList = document.getElementById('notificationsList');
  if (!notificationsList) return;
  
  // Filter notifications
  let filteredNotifications = allNotifications;
  if (currentNotificationFilter === 'unread') {
    filteredNotifications = allNotifications.filter(n => !n.read);
  } else if (currentNotificationFilter === 'read') {
    filteredNotifications = allNotifications.filter(n => n.read);
  }
  
  console.log(`[Notifications] Displaying ${filteredNotifications.length} notifications`);
  
  // Clear list
  notificationsList.innerHTML = '';
  
  // Show empty state if no notifications
  if (filteredNotifications.length === 0) {
    const emptyMessage = currentNotificationFilter === 'all' 
      ? 'No notifications yet' 
      : `No ${currentNotificationFilter} notifications`;
    
    notificationsList.innerHTML = `
      <div style="text-align: center; padding: 60px 20px; color: #999;">
        <div style="font-size: 3rem; margin-bottom: 16px;">ğŸ””</div>
        <p style="font-size: 1.1rem; font-weight: 500;">${emptyMessage}</p>
      </div>
    `;
    return;
  }
  
  // Render each notification
  filteredNotifications.forEach(notification => {
    const notifElement = createNotificationElement(notification);
    notificationsList.appendChild(notifElement);
  });
  
  console.log('[Notifications] âœ“ Notifications rendered');
}

/**
 * Create notification element
 */
function createNotificationElement(notification) {
  const div = document.createElement('div');
  div.className = `notification-item ${notification.read ? 'read' : 'unread'}`;
  div.dataset.id = notification.id;
  
  // Determine icon based on type
  let icon = 'ğŸ””';
  let iconClass = 'type-reminder';
  
  if (notification.type === 'booking_reminder') {
    icon = 'ğŸ””';
    iconClass = 'type-reminder';
  } else if (notification.type === 'status_change') {
    icon = 'âœ…';
    iconClass = 'type-status';
  } else if (notification.type === 'admin_message') {
    icon = 'ğŸ“¢';
    iconClass = 'type-message';
  }
  
  // Format time ago
  const timeAgo = formatTimeAgo(notification.createdAt);
  
  // Build type badge text
  let typeBadgeText = 'Notification';
  if (notification.requestType === 'tents-chairs') {
    typeBadgeText = 'Tents & Chairs';
  } else if (notification.requestType === 'conference-room') {
    typeBadgeText = 'Conference Room';
  }
  
  div.innerHTML = `
    <div class="notification-icon ${iconClass}">${icon}</div>
    <div class="notification-content">
      <h3 class="notification-title">${sanitizeInput(notification.title)}</h3>
      <p class="notification-message">${sanitizeInput(notification.message)}</p>
      <div class="notification-meta">
        ${notification.requestType ? `<span class="notification-type-badge">${typeBadgeText}</span>` : ''}
        <span class="notification-time">ğŸ•’ ${timeAgo}</span>
      </div>
    </div>
    <div class="notification-actions">
      ${!notification.read ? `
        <button class="notification-action-btn mark-read" data-action="mark-read">
          Mark as Read
        </button>
      ` : ''}
      ${notification.requestId ? `
        <button class="notification-action-btn view-request" data-action="view-request" data-request-id="${notification.requestId}" data-request-type="${notification.requestType}">
          View Request
        </button>
      ` : ''}
      <button class="notification-action-btn delete" data-action="delete">
        Delete
      </button>
    </div>
  `;
  
  // Add event listeners
  div.querySelectorAll('.notification-action-btn').forEach(btn => {
    btn.addEventListener('click', async (e) => {
      e.stopPropagation();
      const action = btn.dataset.action;
      
      if (action === 'mark-read') {
        await markNotificationAsRead(notification.id);
      } else if (action === 'view-request') {
        const requestId = btn.dataset.requestId;
        const requestType = btn.dataset.requestType;
        await viewRequestFromNotification(requestId, requestType);
      } else if (action === 'delete') {
        await deleteNotification(notification.id);
      }
    });
  });
  
  // Click anywhere on notification to mark as read (if unread)
  if (!notification.read) {
    div.addEventListener('click', () => {
      markNotificationAsRead(notification.id);
    });
  }
  
  return div;
}

/**
 * Mark notification as read
 */
async function markNotificationAsRead(notificationId) {
  console.log(`[Notifications] Marking notification as read: ${notificationId}`);
  
  try {
    await updateDoc(doc(db, "notifications", notificationId), {
      read: true
    });
    
    console.log('[Notifications] âœ“ Notification marked as read');
    
    // Reload notifications
    await loadNotifications();
    
  } catch (error) {
    console.error('[Notifications] âŒ Error marking as read:', error);
    showToast('Error updating notification', false);
  }
}

/**
 * Mark all notifications as read
 */
async function markAllNotificationsAsRead() {
  console.log('[Notifications] Marking all notifications as read...');
  
  const unreadNotifications = allNotifications.filter(n => !n.read);
  
  if (unreadNotifications.length === 0) {
    console.log('[Notifications] No unread notifications to mark');
    return;
  }
  
  try {
    // Update all unread notifications
    const promises = unreadNotifications.map(n => 
      updateDoc(doc(db, "notifications", n.id), { read: true })
    );
    
    await Promise.all(promises);
    
    console.log(`[Notifications] âœ“ Marked ${unreadNotifications.length} notifications as read`);
    showToast('All notifications marked as read', true);
    
    // Reload notifications
    await loadNotifications();
    
  } catch (error) {
    console.error('[Notifications] âŒ Error marking all as read:', error);
    showToast('Error updating notifications', false);
  }
}

/**
 * Delete notification
 */
async function deleteNotification(notificationId) {
  console.log(`[Notifications] Deleting notification: ${notificationId}`);
  
  // Confirm deletion
  const confirmed = confirm('Are you sure you want to delete this notification?');
  if (!confirmed) {
    console.log('[Notifications] Deletion cancelled by user');
    return;
  }
  
  try {
    await deleteDoc(doc(db, "notifications", notificationId));
    
    console.log('[Notifications] âœ“ Notification deleted');
    showToast('Notification deleted', true);
    
    // Reload notifications
    await loadNotifications();
    
  } catch (error) {
    console.error('[Notifications] âŒ Error deleting notification:', error);
    showToast('Error deleting notification', false);
  }
}

/**
 * View request from notification
 */
async function viewRequestFromNotification(requestId, requestType) {
  console.log(`[Notifications] Opening request: ${requestId} (${requestType})`);
  
  // Switch to Requests tab
  const requestsTab = document.querySelector('.profile-tab[data-tab="requests"]');
  if (requestsTab) {
    requestsTab.click();
    
    // Wait for tab to switch, then find and click request card
    setTimeout(() => {
      const requestCard = document.querySelector(`.request-card[data-id="${requestId}"]`);
      if (requestCard) {
        requestCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
        requestCard.click();
        console.log('[Notifications] âœ“ Request card opened');
      } else {
        console.warn('[Notifications] âš ï¸ Request card not found');
        showToast('Request not found in your list', false);
      }
    }, 300);
  }
}

/**
 * Filter notifications by read status
 */
function filterNotifications(filterType) {
  console.log(`[Notifications] ğŸ” Filtering by: ${filterType}`);
  
  currentNotificationFilter = filterType;
  
  // Update filter button states
  document.querySelectorAll('.notif-filter-btn').forEach(btn => {
    btn.classList.toggle('active', btn.dataset.filter === filterType);
  });
  
  // Re-render notifications
  renderNotifications();
}

/**
 * Start notification count refresh (every 5 minutes)
 */
function startNotificationRefresh() {
  console.log('[Notifications] â° Starting auto-refresh (5 min interval)');
  
  // Refresh every 5 minutes
  setInterval(async () => {
    console.log('[Notifications] â° Auto-refresh triggered');
    await loadNotifications();
  }, 5 * 60 * 1000);
}

/**
 * Format timestamp to "time ago" string
 */
function formatTimeAgo(timestamp) {
  if (!timestamp) return 'Just now';
  
  const now = new Date();
  const past = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
  const diffMs = now - past;
  const diffSeconds = Math.floor(diffMs / 1000);
  const diffMinutes = Math.floor(diffSeconds / 60);
  const diffHours = Math.floor(diffMinutes / 60);
  const diffDays = Math.floor(diffHours / 24);
  
  if (diffSeconds < 60) return 'Just now';
  if (diffMinutes < 60) return `${diffMinutes} min ago`;
  if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;
  if (diffDays < 7) return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;
  
  return past.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
}

// ========================================
// NOTIFICATION FILTER EVENT LISTENERS
// ========================================

document.addEventListener('DOMContentLoaded', () => {
  // Filter buttons
  document.querySelectorAll('.notif-filter-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const filterType = this.dataset.filter;
      filterNotifications(filterType);
    });
  });
  
  // Mark all as read button
  const markAllBtn = document.getElementById('markAllReadBtn');
  if (markAllBtn) {
    markAllBtn.addEventListener('click', markAllNotificationsAsRead);
  }
});
```

---

### 5. **Firestore Security Rules**

**UPDATE** `firestore.rules` (in Firebase Console):

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Existing rules...
    
    // Notifications collection
    match /notifications/{notificationId} {
      // Users can read their own notifications
      allow read: if request.auth != null && resource.data.userId == request.auth.uid;
      
      // Users can update (mark as read) their own notifications
      allow update: if request.auth != null && resource.data.userId == request.auth.uid;
      
      // Users can delete their own notifications
      allow delete: if request.auth != null && resource.data.userId == request.auth.uid;
      
      // Only admins can create notifications (set in admin context)
      allow create: if request.auth != null && get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';
    }
  }
}
```

---

## ğŸš€ Step-by-Step Implementation Guide

### Phase 1: HTML Structure (30 minutes)

1. âœ… **Open `UserProfile.html`**
2. âœ… **Remove bell icon** (lines 53-59)
3. âœ… **Remove notification banners container** (line 64)
4. âœ… **Add tab navigation bar** (after `.user-profile-header`)
5. âœ… **Wrap Personal Info card** in `<div class="tab-pane active" id="infoTab">`
6. âœ… **Wrap Request Status section** in `<div class="tab-pane" id="requestsTab">`
7. âœ… **Add Notifications tab pane** with filters and list container
8. âœ… **Save file**

### Phase 2: CSS Styling (60 minutes)

1. âœ… **Open `style.css`**
2. âœ… **(Optional) Delete Strategy 1+2 styles** (lines 1099-1340)
3. âœ… **Add tab navigation styles** (`.profile-tabs`, `.profile-tab`, etc.)
4. âœ… **Add tab content styles** (`.tab-pane`, animations)
5. âœ… **Add notifications panel styles** (`.notifications-panel`, `.notifications-header`)
6. âœ… **Add notification item styles** (`.notification-item`, `.unread`, `.read`)
7. âœ… **Add responsive styles** (mobile breakpoints)
8. âœ… **Save file**

### Phase 3: JavaScript Logic (90-120 minutes)

1. âœ… **Open `script.js`**
2. âœ… **(Optional) Delete Strategy 1+2 functions** (notification banner code)
3. âœ… **Add tab switching logic** (`initializeProfileTabs()`)
4. âœ… **Add notification loading** (`loadNotifications()`)
5. âœ… **Add notification rendering** (`renderNotifications()`, `createNotificationElement()`)
6. âœ… **Add notification actions** (`markNotificationAsRead()`, `deleteNotification()`)
7. âœ… **Add filter logic** (`filterNotifications()`)
8. âœ… **Add helper functions** (`formatTimeAgo()`, `updateNotificationCounts()`)
9. âœ… **Update UserProfile initialization** to call `loadNotifications()`
10. âœ… **Save file**

### Phase 4: Firestore Setup (15 minutes)

1. âœ… **Open Firebase Console**
2. âœ… **Go to Firestore Database**
3. âœ… **Create new collection**: `notifications`
4. âœ… **Add test document** (see example schema above)
5. âœ… **Update Firestore Rules** (add notifications security rules)
6. âœ… **Save rules**

### Phase 5: Testing (30-60 minutes)

1. âœ… **Create test notifications** in Firestore Console
2. âœ… **Load UserProfile.html** in browser
3. âœ… **Test tab switching** (Personal Info â†’ Requests â†’ Notifications)
4. âœ… **Test notification filters** (All â†’ Unread â†’ Read)
5. âœ… **Test mark as read** (individual and all)
6. âœ… **Test delete notification**
7. âœ… **Test "View Request"** button (should switch to Requests tab)
8. âœ… **Check console logs** for errors
9. âœ… **Test on mobile viewport**

---

## ğŸ”® Future Enhancements (Admin-Side)

Once user-facing notifications are working, you'll need to **CREATE notifications from admin actions**:

### Admin Approval Flow Example

```javascript
// In admin-tents-requests.html (or admin script)

async function approveRequest(requestId) {
  try {
    // 1. Update request status
    await updateDoc(doc(db, "tentsChairsBookings", requestId), {
      status: "approved",
      approvedAt: new Date()
    });
    
    // 2. Get request data
    const requestDoc = await getDoc(doc(db, "tentsChairsBookings", requestId));
    const requestData = requestDoc.data();
    
    // 3. CREATE NOTIFICATION FOR USER
    await addDoc(collection(db, "notifications"), {
      userId: requestData.userId,
      type: "status_change",
      requestId: requestId,
      requestType: "tents-chairs",
      title: "Request Approved",
      message: `Your tents & chairs booking request for ${requestData.startDate} has been approved!`,
      read: false,
      createdAt: new Date(),
      actionUrl: null,
      metadata: {
        oldStatus: "pending",
        newStatus: "approved",
        eventDate: requestData.startDate
      }
    });
    
    console.log('[Admin] âœ“ Request approved and notification created');
    showToast('Request approved successfully', true);
    
  } catch (error) {
    console.error('[Admin] âŒ Error approving request:', error);
  }
}
```

### Notification Types to Implement

1. **Status Changes**:
   - Request approved
   - Request rejected (with reason)
   - Request completed

2. **Booking Reminders** (Cloud Functions):
   - 3 days before event
   - 1 day before event
   - Day of event

3. **Admin Messages**:
   - Important announcements
   - Policy updates
   - Office closure notices

---

## âœ… Final Checklist

Before going live:

- [ ] All HTML changes implemented
- [ ] All CSS styles added and tested
- [ ] All JavaScript functions working
- [ ] Firestore collection created
- [ ] Firestore security rules updated
- [ ] Test notifications created in Firestore
- [ ] Tab switching works smoothly
- [ ] Filter buttons work (All/Unread/Read)
- [ ] Mark as read functionality works
- [ ] Delete notification works
- [ ] "Mark All as Read" button works
- [ ] Unread badge shows correct count
- [ ] Tab badge shows unread count
- [ ] Empty states display correctly
- [ ] Mobile responsive design tested
- [ ] Console logs show no errors
- [ ] Admin notification creation tested

---

## ğŸ“š Benefits of Strategy 3

### Compared to Current Implementation (Strategy 1 + 2):

| Feature | Strategy 1+2 (Current) | Strategy 3 (Proposed) |
|---------|------------------------|----------------------|
| **Persistence** | âŒ Lost on page refresh | âœ… Stored in Firestore |
| **History** | âŒ Shows only current alerts | âœ… Full notification history |
| **Read/Unread** | âŒ No tracking | âœ… Full read/unread system |
| **Notification Types** | âš ï¸ Only booking reminders | âœ… Multiple types (status, admin, etc.) |
| **User Control** | âš ï¸ Can only dismiss banners | âœ… Mark as read, delete, filter |
| **Admin Integration** | âŒ Auto-generated only | âœ… Admins can send custom messages |
| **Scalability** | âš ï¸ Limited | âœ… Easy to add new types |
| **UI Clutter** | âš ï¸ Banners take vertical space | âœ… Hidden in tab, only badge visible |

---

## ğŸ“ Summary

Strategy 3 is the **most professional and scalable** notification system. It requires:

1. **~3-4 hours** of development time
2. **Firestore writes** (but minimal cost for small user base)
3. **Admin-side integration** (to create notifications on status changes)

But you get:
- âœ… Complete notification management
- âœ… Persistent history
- âœ… Professional UX
- âœ… Future-proof architecture

Ready to implement? Let me know and I'll help you through each phase! ğŸš€
