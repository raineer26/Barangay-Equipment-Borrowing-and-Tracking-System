<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Barangay Mapulang Lupa - Login</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@100..900&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <!-- Redirect root to user.html so the landing page is the first thing seen.
       ONLY redirect if accessing via root path (/) or typing index.html in browser.
       Do NOT redirect if coming from a navigation link (has referrer from same site). -->
  <script>
    (function() {
      try {
        // TEMPORARY: Allow direct access for testing (remove after testing spinner)
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('allowDirect') === 'true') {
          console.log('[Index] Direct access allowed via URL parameter');
          return;
        }
        
        // Check if this is a direct visit (typing URL) vs navigation from within the site
        const referrer = document.referrer;
        const isFromSameSite = referrer && (referrer.includes(window.location.hostname) || referrer.includes('localhost') || referrer.includes('127.0.0.1'));
        
        console.log('[Index Redirect Script] referrer:', referrer);
        console.log('[Index Redirect Script] isFromSameSite:', isFromSameSite);
        console.log('[Index Redirect Script] hostname:', window.location.hostname);
        
        // If visitor came from a link on the site (like LOGIN button), show login page
        if (isFromSameSite) {
          console.log('[Index] Navigation from same site detected, showing login page');
          return;
        }
        
        // If accessing root directly (typing URL or bookmark), redirect to landing page
        console.log('[Index] Direct access detected, redirecting to user.html');
        window.location.replace('user.html');
      } catch (e) {
        // If anything fails, don't block the page ‚Äî allow default behaviour
        console.error('Redirect logic failed:', e);
      }
    })();
  </script>
</head>
<body>

  <!-- NAVIGATION -->
  <header>
    <div class="nav-container">
      <div class="logo">
        <img src="Assets/BrgyLogo.png" alt="Barangay Seal">
        <span>BARANGAY MAPULANG LUPA <br> Official Site</span>
      </div>
      
      <!-- Desktop Navigation (hidden on mobile) -->
      <nav>
        <ul>
          <li><a href="user.html">HOME</a></li>
          <li class="dropdown">
            <a href="#">CALENDAR OF ACTIVITIES ‚ñæ</a>
            <ul class="dropdown-menu">
              <li><a href="tents-calendar.html">Tents and Chairs</a></li>
              <li><a href="conference-room.html">Conference Room</a></li>
            </ul>
          </li>
          <li><a href="about.html">ABOUT US</a></li>
          <li><a href="ContactPage.html">CONTACT US</a></li>
          <li><a href="index.html" class="login-btn">LOGIN</a></li>
        </ul>
      </nav>

      <!-- Burger Menu Button (visible on mobile) -->
      <div class="burger-menu" id="burgerMenu">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </header>

  <!-- Mobile Navigation Overlay -->
  <div class="mobile-nav-overlay" id="mobileNavOverlay"></div>

  <!-- Mobile Navigation Menu -->
  <nav class="mobile-nav" id="mobileNav">
    
    <ul>
      <li><a href="user.html">HOME</a></li>
      <li class="dropdown">
        <div class="dropdown-toggle" id="mobileDropdownToggle">
          <span>CALENDAR OF ACTIVITIES</span>
          <span>‚ñæ</span>
        </div>
        <ul class="dropdown-menu" id="mobileDropdownMenu">
          <li><a href="tents-calendar.html">Tents and Chairs</a></li>
          <li><a href="conference-room.html">Conference Room</a></li>
        </ul>
      </li>
      <li><a href="about.html">ABOUT US</a></li>
      <li><a href="ContactPage.html">CONTACT US</a></li>
      <li><a href="index.html" class="login-btn">LOGIN</a></li>
    </ul>
  </nav>

  <!-- HERO LOGIN SECTION -->
  <section class="hero">
    <img src="Assets/Hall.jpg" alt="Barangay Building Background">
    <div class="hero-text">
      <h1>LOGIN</h1>
      <p>HOME | LOGIN</p>
    </div>
  </section>

  <!-- LOGIN FORM -->
  <section class="login-section">
    <form class="login-form" id="loginForm">
      <label for="login-email">EMAIL:</label>
      <input type="email" id="login-email" placeholder="example@gmail.com" required>
      <div class="error-message" id="error-login-email"></div>

      <label for="login-password">PASSWORD:</label>
      <div class="password-wrapper">
        <input type="password" id="login-password" placeholder="Enter your password" required>
        <button type="button" class="password-toggle" data-target="login-password" aria-label="Show password" aria-pressed="false">
          <!-- Eye (show) -->
          <svg class="icon-show" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"></path>
            <circle cx="12" cy="12" r="3"></circle>
          </svg>
          <!-- Eye Off (hide) -->
          <svg class="icon-hide" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M17.94 17.94A10.94 10.94 0 0 1 12 19c-7 0-11-7-11-7a21.84 21.84 0 0 1 5.06-4.94"></path>
            <path d="M1 1l22 22"></path>
            <path d="M14.12 14.12A3 3 0 0 1 9.88 9.88"></path>
            <path d="M10.66 6.6A10.94 10.94 0 0 1 12 5c7 0 11 7 11 7a21.88 21.88 0 0 1-2.44 3.9"></path>
          </svg>
        </button>
      </div>
      <div class="error-message" id="error-login-password"></div>

      <div class="forgot-password-link">
        <a href="#" id="forgotPasswordLink">Forgot Password?</a>
      </div>

      <div class="form-buttons">
        <button type="submit" class="btn primary">LOGIN</button>
        <a href="signup.html" class="btn secondary">SIGNUP</a>
      </div>
    </form>
  </section>

  <!-- Forgot Password Modal -->
  <div id="forgotPasswordModal" class="modal">
    <div class="modal-content">
      <h2>Reset Password</h2>
      <p style="color: #666; margin-bottom: 20px; font-size: 0.9rem;">Enter your email address and we'll send you a link to reset your password.</p>
      <form id="forgotPasswordForm">
        <div class="form-group">
          <label for="resetEmail">Email Address</label>
          <input type="email" id="resetEmail" placeholder="Enter your email" required>
          <div class="error-message" id="error-reset-email"></div>
        </div>
        <div class="modal-buttons">
          <button type="button" class="close-modal">Cancel</button>
          <button type="submit" class="save-changes">Send Reset Link</button>
        </div>
      </form>
    </div>
  </div>
  
  

  <!-- FOOTER -->
  <footer>
    <div class="footer-logo">
        <img src="Assets/BrgyLogo.png" alt="Barangay Seal">
        <p>Barangay Mapulang Lupa <br> Official Site</p>
    </div>
    <div class="footer-container">
      <div class="footer-links">
        <h3>Home</h3>
        <ul>
          <li><a href="user.html#calendar">Calendars</a></li>
          <li><a href="user.html#services">Service Offered</a></li>
          <li><a href="user.html#about">About the Barangay</a></li>
          <li><a href="user.html#contact">Contact Us</a></li>
        </ul>
      </div>
      <div class="footer-links">
        <h3>Calendar of Activities</h3>
        <ul>
          <li><a href="index.html">Tents and Chairs</a></li>
          <li><a href="index.html">Conference Room</a></li>
        </ul>
      </div>
      <div class="footer-links">
        <h3>About Us</h3>
        <ul>
          <li><a href="about.html">About Barangay</a></li>
        </ul>
      </div>
      <div class="footer-links">
        <h3>Contact Us</h3>
        <p>üìç <a href="https://maps.app.goo.gl/xXJGqRTvFjYpEo2E7" target="_blank" rel="noopener noreferrer" style="color: inherit; text-decoration: none; cursor: pointer;">Address: 3S Center, Orosco St. Mapulang Lupa, Valenzuela City, Metro Manila</a></p>
        <p>üìû Phone: (02) 8807-1557</p>
        <p>üìß <a href="https://mail.google.com/mail/?view=cm&fs=1&to=barangaymapulanglupa@gmail.com" target="_blank" rel="noopener noreferrer" style="color: inherit; text-decoration: none; cursor: pointer;">Email: barangaymapulanglupa@gmail.com</a></p>
      </div>
    </div>
    <div class="footer-bottom">
      <p>¬© 2025 Barangay Mapulang Lupa. Website Design by F5.</p>
    </div>
  </footer>

  <!-- FIREBASE LOGIN SCRIPT -->
  <script type="module" src="script.js"></script>
</body>
</html>
